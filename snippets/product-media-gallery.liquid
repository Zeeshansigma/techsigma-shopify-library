<style>
  .product__image-slider {
    width: 100%;
  }

  .product__image-slider .carousel-cell {
    width: 100%;
    height: auto;
    margin: 0 5px
  }

  .product__image-slider .carousel-cell img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    object-position: center center;
  }

  .grid__item .product__image-slider {
    margin-bottom: 2rem;
  }

  .product__image-slider .flickity-viewport {
    transition: height 0.2s;
  }

  .flickity-button:disabled {
    display: none;
  }

  .product__image-thumbnail .carousel-cell {
    width: 20%;
    margin-right: 0 !important;
  }

  .product__image-thumbnail .carousel-cell img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    object-position: center;
  }

  .product__image-thumbnail .carousel-cell img {
    /* height:87px !important; */
    opacity: 0.4;
    margin-right: 0 !important;
    /* width: 87px !important; */
  }
  .product__image-thumbnail .flickity-viewport {
    height: 87px !important;
  }
  .product__image-thumbnail .carousel-cell {
    height: 87px !important;
  }
  .product__image-thumbnail .carousel-cell {
    width: 12% !important;
  }
  .carousel-cell.is-selected.is-nav-selected img {
    opacity: unset;
  }
  .product__image-slider .flickity-viewport {
    ;
    height: 549px !important;
  }
  .product__image-slider .carousel-cell {
    height: 549px !important;
    text-align: center;
  }
  .carousel-cell video {
    ;
    /* height: 549px !important; */
  }
  @media screen and (min-width: 990px) {
    .product:not(.product--no-media):not(.featured-product) .product__media-wrapper {
      max-width: 50% !important;
      width: calc(50% - 1rem / 2) !important;
    }

    .product:not(.product--no-media):not(.featured-product) .product__info-wrapper {
      max-width: 50% !important;
      width: calc(50% - 1rem / 2) !important;
    }
  }


  .play-button {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 26.514px;
    height: 26.769px;
    background-color: var(--electronic-indigo, #6219FA); /* Set the background color of your play button */
    border-radius: 50%; /* Make it a circle */
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;

  }

  .flickity-prev-next-button .flickity-button-icon {
    position: unset !important;
    left: 20%;
    top: 20%;
    width: 16px !important;
    height: 16px !important;
    flex-shrink: 0;
  }
  .flickity-prev-next-button.previous {
    display: flex;
    width: 60px;
    height: 59.937px;
    justify-content: center;
    align-items: center;
    gap: 12px;
    flex-shrink: 0;
    border-radius: 28px;
    border: 1px solid #EAECF0;
    background: rgba(255, 255, 255, 0.90);
    /* opacity: 0.3; */
  }
  .flickity-prev-next-button.next {
    display: flex;
    width: 60px;
    height: 59.937px;
    justify-content: center;
    align-items: center;
    gap: 12px;
    flex-shrink: 0;
    border-radius: 28px;
    border: 1px solid #EAECF0;
    background: rgba(255, 255, 255, 0.90);
    /*opacity: 0.3;*/
  }
  .carousel.product__image-thumbnail.flickity-enabled.is-draggable {
    box-shadow: none;
  }
  .carousel.product__image-slider.flickity-enabled.is-draggable {
    box-shadow: none;
  }
  @media screen and (max-width: 990px) {
    .product__image-thumbnail .flickity-viewport {
      height: 46px !important;
    }
    .product__image-thumbnail .carousel-cell {
      height: 46px !important;
    }
    .product__image-slider .flickity-viewport {
      ;
      height: 295px !important;
    }
    .product__image-slider .carousel-cell {
      ;
      height: 295px !important;
    }
  }
  @media screen and (max-width:640px) {
    .flickity-prev-next-button.next,
    .flickity-prev-next-button.previous {
      width: 40px;
      height: 40px;
    }
  }
</style>

{% comment %}
Renders a product media gallery. Should be used with 'media-gallery.js'
Also see 'product-media-modal'

Accepts:
- product: {Object} Product liquid object
- variant_images: {Array} Product images associated with a variant
- is_duplicate: {Boolean} Prevents rendering uneeded elements and duplicate ids for subsequent instances

Usage:
{% render 'product-media-gallery', is_duplicate: true %}
{% endcomment %}{%- liquid
  if section.settings.hide_variants and variant_images.size == product.media.size
    assign single_media_visible = true
  endif

  assign media_count = product.media.size
  if section.settings.hide_variants and media_count > 1 and variant_images.size > 0
    assign media_count = media_count | minus: variant_images.size | plus: 1
  endif

  if media_count == 1 or single_media_visible
    assign single_media_visible_mobile = true
  endif

  if media_count == 0 or single_media_visible_mobile or section.settings.mobile_thumbnails == 'show' or section.settings.mobile_thumbnails == 'columns' and media_count < 3
    assign hide_mobile_slider = true
  endif

  if section.settings.media_size == 'large'
    assign media_width = 0.65
  elsif section.settings.media_size == 'medium'
    assign media_width = 0.55
  elsif section.settings.media_size == 'small'
    assign media_width = 0.45
  endif

  assign id_append = ''
  if is_duplicate
    assign id_append = '-duplicate'
  endif
-%}

  <media-gallery
  id="MediaGallery-{{ section.id }}{{ id_append }}"
  role="region"
  {% if section.settings.enable_sticky_info %}
  class="product__column-sticky"
  {% endif %}
  aria-label="{{ 'products.product.media.gallery_viewer' | t }}"
  data-desktop-layout="{{ section.settings.gallery_layout }}">
  <div
    id="GalleryStatus-{{ section.id }}"
    class="visually-hidden"
    role="status"></div>
  {% comment %} <slider-component id="GalleryViewer-{{ section.id }}{{ id_append }}" class="slider-mobile-gutter">
  {%- unless is_duplicate -%}
  <a class="skip-to-content-link button visually-hidden quick-add-hidden" href="#ProductInfo-{{ section.id }}">
  {{ 'accessibility.skip_to_product_info' | t }}
  </a>
  {%- endunless -%}
  <ul
  id="Slider-Gallery-{{ section.id }}{{ id_append }}"
  class="product__media-list contains-media grid grid--peek list-unstyled slider slider--mobile"
  role="list"
  >
  {%- if product.selected_or_first_available_variant.featured_media != null -%}
  {%- assign featured_media = product.selected_or_first_available_variant.featured_media -%}
  <li
  id="Slide-{{ section.id }}-{{ featured_media.id }}{{ id_append }}"
  class="product__media-item grid__item slider__slide is-active{% if single_media_visible %} product__media-item--single{% endif %}{% if featured_media.media_type != 'image' %} product__media-item--full{% endif %}{% if section.settings.hide_variants and variant_images contains featured_media.src %} product__media-item--variant{% endif %}{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--fade-in{% endif %}"
  data-media-id="{{ section.id }}-{{ featured_media.id }}"
  >
  {%- assign media_position = 1 -%}
  {% render 'product-thumbnail',
  media: featured_media,
  media_count: media_count,
  position: media_position,
  desktop_layout: section.settings.gallery_layout,
  mobile_layout: section.settings.mobile_thumbnails,
  loop: section.settings.enable_video_looping,
  modal_id: section.id,
  xr_button: true,
  media_width: media_width,
  media_fit: section.settings.media_fit,
  constrain_to_viewport: section.settings.constrain_to_viewport,
  lazy_load: false
  %}
  </li>
  {%- endif -%}
  {%- for media in product.media -%}
  {%- unless media.id == product.selected_or_first_available_variant.featured_media.id -%}
  <li
  id="Slide-{{ section.id }}-{{ media.id }}{{ id_append }}"
  class="product__media-item grid__item slider__slide{% if single_media_visible %} product__media-item--single{% endif %}{% if product.selected_or_first_available_variant.featured_media == null and forloop.index == 1 %} is-active{% endif %}{% if media.media_type != 'image' %} product__media-item--full{% endif %}{% if section.settings.hide_variants and variant_images contains media.src %} product__media-item--variant{% endif %}{% if settings.animations_reveal_on_scroll %} scroll-trigger animate--fade-in{% endif %}"
  data-media-id="{{ section.id }}-{{ media.id }}"
  >
  {%- liquid
  assign media_position = media_position | default: 0 | plus: 1
  assign lazy_load = false
  if media_position > 1
  assign lazy_load = true
  endif
  -%}
  {% render 'product-thumbnail',
  media: media,
  media_count: media_count,
  position: media_position,
  desktop_layout: section.settings.gallery_layout,
  mobile_layout: section.settings.mobile_thumbnails,
  loop: section.settings.enable_video_looping,
  modal_id: section.id,
  xr_button: true,
  media_width: media_width,
  media_fit: section.settings.media_fit,
  constrain_to_viewport: section.settings.constrain_to_viewport,
  lazy_load: lazy_load
  %}
  </li>
  {%- endunless -%}
  {%- endfor -%}
  </ul>
  {%- unless is_duplicate -%}
  <div class="slider-buttons no-js-hidden quick-add-hidden{% if hide_mobile_slider %} small-hide{% endif %}">
  <button
  type="button"
  class="slider-button slider-button--prev"
  name="previous"
  aria-label="{{ 'general.slider.previous_slide' | t }}"
  >
  {% render 'icon-caret' %}
  </button>
  <div class="slider-counter caption">
  <span class="slider-counter--current">1</span>
  <span aria-hidden="true"> / </span>
  <span class="visually-hidden">{{ 'general.slider.of' | t }}</span>
  <span class="slider-counter--total">{{ media_count }}</span>
  </div>
  <button
  type="button"
  class="slider-button slider-button--next"
  name="next"
  aria-label="{{ 'general.slider.next_slide' | t }}"
  >
  {% render 'icon-caret' %}
  </button>
  </div>
  {%- endunless -%}
  </slider-component> {% endcomment %}{% if product.images != null %}
    <div
      class="carousel product__image-slider"
      role="document"
      aria-label="{{ 'products.modal.label' | t }}"
      tabindex="0">
      {%- for media in product.media -%}
        <div class="carousel-cell">
          {% if media.media_type == "video" %}
            {{ media | media_tag: image_size: "720x", autoplay: false, loop: loop, controls: true, preload: "none", autoplay: false, height: "100%", width: "100%" }}
          {% else %}
            <img
              data-flickity-lazyload-srcset="
                                                                                                                                                                                                                                                                                                                                                                                                            {{ media | img_url: '1440x' }} 1440w,
                                                                                                                                                                                                                                                                                                                                                                                                            {{ media | img_url: '1080x' }} 1080w,
                                                                                                                                                                                                                                                                                                                                                                                                            {{ media | img_url: '720x' }} 767w,
                                                                                                                                                                                                                                                                                                                                                                                                            {{ media | img_url: '480x' }} 480w"
              sizes="(min-width: 480px) 1440px, 1080px, 767px, 480px"
              data-flickity-lazyload-src="{{ media | img_url: 'master' }}"
              alt="{{ media.alt | escape }}"
              border="0"
              data-media-id="{{ media.id }}" />
          {% endif %}
        </div>
      {%- endfor -%}
      <!--- Coded by bluish.io --->
    </div>
    {% if product.images.size > 1 %}
      <div class="carousel product__image-thumbnail">
        {%- for media in product.media -%}

          <div class="carousel-cell">
            {% if media.media_type == "video" %}
              <div class="play-button">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="9"
                  height="9"
                  viewBox="0 0 9 9"
                  fill="none">
                  <g clip-path="url(#clip0_139_2078)">
                    <path
                      d="M2.32422 1.77808C2.32422 1.45436 2.32422 1.2925 2.39172 1.20328C2.45052 1.12555 2.54039 1.07745 2.63769 1.07164C2.74937 1.06497 2.88404 1.15475 3.15339 1.33432L6.65859 3.67111C6.88115 3.81948 6.99242 3.89368 7.03119 3.98718C7.06512 4.06894 7.06512 4.16081 7.03119 4.24258C6.99242 4.33608 6.88115 4.41024 6.65859 4.55864L3.15339 6.89541C2.88404 7.07498 2.74937 7.16478 2.63769 7.15811C2.54039 7.15231 2.45052 7.10421 2.39172 7.02648C2.32422 6.93724 2.32422 6.77538 2.32422 6.45168V1.77808Z"
                      stroke="white"
                      stroke-width="0.5"
                      stroke-linecap="round"
                      stroke-linejoin="round" />
                  </g>
                  <defs>
                    <clipPath id="clip0_139_2078">
                      <rect
                        width="8"
                        height="8"
                        fill="white"
                        transform="translate(0.657227 0.115234)" />
                    </clipPath>
                  </defs>
                </svg>
              </div>
            {% endif %}
            <img
              data-flickity-lazyload-srcset="
                                                                                                                                                                                                                                                                                                                                                                                                            {{ media | img_url: '1440x' }} 1440w,
                                                                                                                                                                                                                                                                                                                                                                                                            {{ media | img_url: '1080x' }} 1080w,
                                                                                                                                                                                                                                                                                                                                                                                                            {{ media | img_url: '720x' }} 767w,
                                                                                                                                                                                                                                                                                                                                                                                                            {{ media | img_url: '480x' }} 480w"
              sizes="(min-width: 480px) 1440px, 1080px, 767px, 480px"
              data-flickity-lazyload-src="{{ media | img_url: 'master' }}"
              alt="{{ media.alt | escape }}"
              border="0"
              data-media-id="{{ media_id }}" />
          </div>

        {%- endfor -%}
        <!--- Coded by ramzanmalik.in --->

      </div>
    {% endif %}
  {% else %}
    {{ 'product-1' | placeholder_svg_tag }}
  {% endif %}

  {%- if first_3d_model -%}
    <button
      class="button button--full-width product__xr-button"
      type="button"
      aria-label="{{ 'products.product.xr_button_label' | t }}"
      data-shopify-xr
      data-shopify-model3d-id="{{ first_3d_model.id }}"
      data-shopify-title="{{ product.title | escape }}"
      data-shopify-xr-hidden>
      {% render 'icon-3d-model' %}
      {{ 'products.product.xr_button' | t }}
    </button>
  {%- endif -%}
  {%- if media_count > 1
 and section.settings.gallery_layout contains 'thumbnail'
 or section.settings.mobile_thumbnails == 'show'
 -%}
    {% comment %} <slider-component
    id="GalleryThumbnails-{{ section.id }}{{ id_append }}"
    class="thumbnail-slider slider-mobile-gutter quick-add-hidden{% unless section.settings.gallery_layout contains 'thumbnail' %} medium-hide large-up-hide{% endunless %}{% if section.settings.mobile_thumbnails != 'show' %} small-hide{% endif %}{% if media_count <= 3 %} thumbnail-slider--no-slide{% endif %}"
    >
    <button
    type="button"
    class="slider-button slider-button--prev{% if media_count <= 3 %} small-hide{% endif %}{% if media_count <= 4 %} medium-hide large-up-hide{% endif %}"
    name="previous"
    aria-label="{{ 'general.slider.previous_slide' | t }}"
    aria-controls="GalleryThumbnails-{{ section.id }}"
    data-step="3"
    >
    {% render 'icon-caret' %}
    </button>
    <ul
    id="Slider-Thumbnails-{{ section.id }}{{ id_append }}"
    class="thumbnail-list list-unstyled slider slider--mobile{% if section.settings.gallery_layout == 'thumbnail_slider' %} slider--tablet-up{% endif %}"
    >
    {%- capture sizes -%}
    (min-width: {{ settings.page_width }}px) calc(({{ settings.page_width | minus: 100 | times: media_width | round }} - 4rem) / 4),
    (min-width: 990px) calc(({{ media_width | times: 100 }}vw - 4rem) / 4),
    (min-width: 750px) calc((100vw - 15rem) / 8),
    calc((100vw - 8rem) / 3)
    {%- endcapture -%}

    {%- if featured_media != null -%}
    {%- liquid
    capture media_index
    if featured_media.media_type == 'model'
    increment model_index
    elsif featured_media.media_type == 'video' or featured_media.media_type == 'external_video'
    increment video_index
    elsif featured_media.media_type == 'image'
    increment image_index
    endif
    endcapture
    assign media_index = media_index | plus: 1
    -%}
    <li
    id="Slide-Thumbnails-{{ section.id }}-0{{ id_append }}"
    class="thumbnail-list__item slider__slide{% if section.settings.hide_variants and variant_images contains featured_media.src %} thumbnail-list_item--variant{% endif %}"
    data-target="{{ section.id }}-{{ featured_media.id }}"
    data-media-position="{{ media_index }}"
    >
    {%- capture thumbnail_id -%}
    Thumbnail-{{ section.id }}-0{{ id_append }}
    {%- endcapture -%}
    <button
    class="thumbnail global-media-settings global-media-settings--no-shadow"
    aria-label="{%- if featured_media.media_type == 'image' -%}{{ 'products.product.media.load_image' | t: index: media_index }}{%- elsif featured_media.media_type == 'model' -%}{{ 'products.product.media.load_model' | t: index: media_index }}{%- elsif featured_media.media_type == 'video' or featured_media.media_type == 'external_video' -%}{{ 'products.product.media.load_video' | t: index: media_index }}{%- endif -%}"
    aria-current="true"
    aria-controls="GalleryViewer-{{ section.id }}{{ id_append }}"
    aria-describedby="{{ thumbnail_id }}"
    >
    {{
    featured_media.preview_image
    | image_url: width: 416
    | image_tag:
    loading: 'lazy',
    sizes: sizes,
    widths: '54, 74, 104, 162, 208, 324, 416',
    id: thumbnail_id,
    alt: featured_media.alt
    | escape
    }}
    </button>
    </li>
    {%- endif -%}
    {%- for media in product.media -%}
    {%- unless media.id == product.selected_or_first_available_variant.featured_media.id -%}
    {%- liquid
    capture media_index
    if media.media_type == 'model'
    increment model_index
    elsif media.media_type == 'video' or media.media_type == 'external_video'
    increment video_index
    elsif media.media_type == 'image'
    increment image_index
    endif
    endcapture
    assign media_index = media_index | plus: 1
    -%}
    <li
    id="Slide-Thumbnails-{{ section.id }}-{{ forloop.index }}{{ id_append }}"
    class="thumbnail-list__item slider__slide{% if section.settings.hide_variants and variant_images contains media.src %} thumbnail-list_item--variant{% endif %}"
    data-target="{{ section.id }}-{{ media.id }}"
    data-media-position="{{ media_index }}"
    >
    {%- if media.media_type == 'model' -%}
    <span class="thumbnail__badge" aria-hidden="true">
    {%- render 'icon-3d-model' -%}
    </span>
    {%- elsif media.media_type == 'video' or media.media_type == 'external_video' -%}
    <span class="thumbnail__badge" aria-hidden="true">
    {%- render 'icon-play' -%}
    </span>
    {%- endif -%}
    {%- capture thumbnail_id -%}
    Thumbnail-{{ section.id }}-{{ forloop.index }}{{ id_append }}
    {%- endcapture -%}
    <button
    class="thumbnail global-media-settings global-media-settings--no-shadow"
    aria-label="{%- if media.media_type == 'image' -%}{{ 'products.product.media.load_image' | t: index: media_index }}{%- elsif media.media_type == 'model' -%}{{ 'products.product.media.load_model' | t: index: media_index }}{%- elsif media.media_type == 'video' or media.media_type == 'external_video' -%}{{ 'products.product.media.load_video' | t: index: media_index }}{%- endif -%}"
    {% if media == product.selected_or_first_available_variant.featured_media
    or product.selected_or_first_available_variant.featured_media == null
    and forloop.index == 1
    %}
    aria-current="true"
    {% endif %}
    aria-controls="GalleryViewer-{{ section.id }}{{ id_append }}"
    aria-describedby="{{ thumbnail_id }}"
    >
    {{
    media.preview_image
    | image_url: width: 416
    | image_tag:
    loading: 'lazy',
    sizes: sizes,
    widths: '54, 74, 104, 162, 208, 324, 416',
    id: thumbnail_id,
    alt: media.alt
    | escape
    }}
    </button>
    </li>
    {%- endunless -%}
    {%- endfor -%}
    </ul>
    <button
    type="button"
    class="slider-button slider-button--next{% if media_count <= 3 %} small-hide{% endif %}{% if media_count <= 4 %} medium-hide large-up-hide{% endif %}"
    name="next"
    aria-label="{{ 'general.slider.next_slide' | t }}"
    aria-controls="GalleryThumbnails-{{ section.id }}"
    data-step="3"
    >
    {% render 'icon-caret' %}
    </button>
    </slider-component> {% endcomment %}
  {%- endif -%}
</media-gallery>
<script>
  var elem = document.querySelector('.carousel.product__image-slider');
  var flkty = new Flickity(elem, {
    contain: true,
    imagesLoaded: true,
    lazyLoad: 1,
    wrapAround: true,
    pageDots: false,{% if product.images.size < 2 %}prevNextButtons : false,{% endif %}adaptiveHeight: true
  });
  console.log("check product main Slider:", flkty);

  var elemThumbnail = document.querySelector('.carousel.product__image-thumbnail');
  var flktyB = new Flickity(elemThumbnail, {
    asNavFor: '.carousel.product__image-slider',
    contain: true,
    imagesLoaded: true,
    lazyLoad: 7,
    pageDots: false,
    prevNextButtons: false
  });
  if (flktyB.cells.length < 2) {
    console.log("images check in product media");
    flktyB.options.draggable = false;
    flkty.options.prevNextButtons = false;
    flktyB.updateDraggable();
    flkty.reloadCells();
    flktyB.reloadCells();
  }
  console.log("check thumb slides:", flktyB.cells.length);
</script>