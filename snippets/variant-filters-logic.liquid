{% assign kistler_metafield = prod_variant.metafields.kistler %}
{% assign show = false %}
{% assign matched_filters = 0 %}
{% assign active_filters_size = 0 %}

{% for filter in collection.filters %}
{% assign downcaseFilter = filter.label | downcase | replace: " ", "_" %}
{% if filter.active_values.size > 0 %}
{% assign active_filters_size = active_filters_size | plus: 1 %}
{% assign filter_matched = false %} 
{% for active_filter in filter.active_values %}
{% assign meta_v =  kistler_metafield[downcaseFilter] | remove: "'" | remove: '"' %}
{% assign filter_v =  active_filter.label | remove: "'" | remove: '"' %}
{% if meta_v contains filter_v and filter_matched == false %}
{% assign matched_filters = matched_filters | plus: 1 %}
{% assign filter_matched = true %} 
{% endif %} 
{% endfor %}  
{% endif %} 
{% endfor %}

{% if active_filters_size == matched_filters %}
{% assign class = "show" %}
{% else %}
{% assign class = "hide" %}
{% endif %}
